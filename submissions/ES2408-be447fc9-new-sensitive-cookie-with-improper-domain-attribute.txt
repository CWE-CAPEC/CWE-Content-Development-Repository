SUBMISSION COMMUNICATION ID: ES2408-be447fc9

ACTION TYPE: New Entry

SUBMISSION STATUS: Init-Consultation

AFFECTED CWES: 

ORIGIN: sub-server

SUBMISSION DATE: 2024-08-26 11:07:10

ISSUES: yes/resolved

ISSUE DETAILS: 

PUBTRACKER: #127

MTRACKER: #1159

GITHUBUSER: 

SUBMISSION TYPE: Software

NAME: Sensitive Cookie with Improper Domain Attribute

DESCRIPTION:

The Domain attribute for a sensitive cookies is set with an overly
permissive value causing it to be sent to unintended hosts.

The Domain attribute controls to which FQDN a cookie is sent with requests
to. When the Domain attribute is not set, it will only be sent with
requests to the FQDN the cookie was set by, which is the most secure
configuration. When the Domain attribute is set, it will be sent with
requests to the FQDN and its immediate subdomains. 

This is often done either by mistake, when without the Domain attribute
would have sufficed, or on purpose for convenience so that the cookie will
be sent with requests for some intended sibling subdomains, but
intentionally also causes the cookie to be sent to FQDNs that do not use
the cookie.

In the case of a sensitive cookie, such as a cookie used for
authentication, or otherwise storing sensitive data, this causes
inadvertent improper transmission of sensitive data including making
possible session hijacking/theft attacks.

RELATED WEAKNESSES:

   ChildOf CWE-732

REFERENCES:

Title: Cookie Broadcasting
URL: https://security.synotna.eu/cookie-broadcasting.html

Title: Testing for Cookies Attributes
URL: https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes

Title: Subdomain takeover
URL: https://developer.mozilla.org/en-US/docs/Web/Security/Attacks/Subdomain_takeover

Title: Understanding Insecure Cookie Setting: Domain Too Loose
URL: https://izoologic.com/web-app-security/understanding-insecure-cookie-setting-domain-too-loose/

Title: Cookie security: overly broad domain
URL: https://codeql.github.com/codeql-query-help/csharp/cs-web-broad-cookie-domain/

Title: Security Cookies: Cookie Attributes and Vulnerability Guide
URL: https://www.invicti.com/white-papers/security-cookies-whitepaper

Title: Session cookies scoped to parent domain
URL: https://www.acunetix.com/vulnerabilities/web/session-cookies-scoped-to-parent-domain/



ACTIVE ISSUES:



RESOLVED ISSUES:

SUB.RELS - "Unclear relationships"

Description: The submission suggests some relationships, but the
name/description is not explained in a way in which the relationship is
relevant; or, the weakness is apparent, but it is not clear what the best
parent/child relationship(s) would be.

Resolution: The submission cannot progress to the next phase if SUB.UNCLEAR
is present. It can progress to other phases if the CWE Team agrees that the
potential relationships may require closer investigation.  The submission
cannot progress to the Publication stage until clear relationships and
direct parents are identified. The CWE Team may decide to use high-level
relationships (e.g., to Pillars) if deeper problems such as SUB.ABS.SUBTREE
exist and cannot be quickly resolved.

Comments: The suggested relationships of CWE-923 and CWE-522 as potential parents
do not appear to be the best fit.  CWE-923 is about establishing a communication channel
to unintended endpoints.  While an overly permissive domain attribute could lead to a 
sensitive cookie being added to a request when it shouldn't have, the root of the issue is
the assignment of the Domain attribute, not establishing a communication channel.  CWE-522
is about not protecting credentials, and while by setting an overly permissive domain attribute
may lead to insufficiently protected credentials inside an authentication cookie, not all sensitive
cookies are for credentials.  This weakness is a permissions issue and the CWE team believes that 
it would best fit as a child to CWE-732: Incorrect Permission Assignment for Critical Resource.  
One of the other children to CWE-732 is CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag, which
is very adjacent to the proposed weakness.  Please indicate if you agree with this newly suggested
relationship.

Response: [RESOLVED ISSUE; DO NOT CHANGE.]

I agree


-------

SUB.RELREFS - "No relevant references"

Description: The submission does not provide relevant references that
explain the weakness, or the relevance is not easily found.

Resolution: The submission is not likely to progress to later phases if
there are no applicable, easily-accessible references. The submitter could
resolve by providing additional details such as a section name and quote
from the reference.  If no suitable references can be found, the CWE Team
may decide to make an exception.

Comments: The submission provides a reference that appears to describe "cookie broadcasting",
although when the CWE team attempted to view the reference the page was not loading.  Please double
check that the link to the intended reference is correct and if the intended reference is not 
accessible please provide another reference.

Response: [RESOLVED ISSUE; DO NOT CHANGE. ADDITIONAL REFERENCES FOUND BY CWE TEAM].

I have repaired the reference at
https://security.synotna.eu/cookie-broadcasting.html - which is simply my
own write up explaining the vulnerability 


TIMELINE:

Received: 2024-08-26

Ack-Receipt: 2024-12-09

Init-Review: 2025-01-24

Init-Consultation: 2025-08-25

Init-Declined: YYYY-MM-DD

Init-Accepted: YYYY-MM-DD

Det-Requested: YYYY-MM-DD

Det-Received: YYYY-MM-DD

Det-Review: YYYY-MM-DD

Det-Consultation: YYYY-MM-DD

Det-Accepted: YYYY-MM-DD

Internal-Update: YYYY-MM-DD

CWE-Assigned: YYYY-MM-DD

CWE-Modified: YYYY-MM-DD

Final-Coord: YYYY-MM-DD

CWE-Published: YYYY-MM-DD

Post-Publication: YYYY-MM-DD

Closed: YYYY-MM-DD




COMMUNICATIONS LOG:
2024-12-09 sent email
2025-01-24 sent email
2025-08-25 sent email
2025-10-11 received comment
