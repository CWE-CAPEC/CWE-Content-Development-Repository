SUBMISSION COMMUNICATION ID: ES2502-23de6290

ACTION TYPE: Modification

SUBMISSION STATUS: Det-Requested

AFFECTED CWES: 

ORIGIN: sub-server

SUBMISSION DATE: 2025-02-28 15:37:18

ISSUES: yes/active

ISSUE DETAILS: SUB.MISSDET

FIELDCHANGE: DEMOX

PUBTRACKER: #144

MTRACKER: #1236

GITHUBUSER: ctflearner

SUBMISSION TYPE: Software

NAME: CWE-1284 modification new demonstrative example

DESCRIPTION:

I want to suggest the below code for PHP language for the given
description.

Demonstrative Examples

````
<?php
$discount = $_POST['discount'];
$originalPrice = 100.00;
$finalPrice = $originalPrice - ($originalPrice * $discount / 100);
processPayment($finalPrice);
?>
````
This PHP code allows users to apply a discount to an item but does not
validate or restrict the discount percentage. An attacker could submit a
100% or even a negative discount value, making the finalPrice zero or
negative. This could result in unauthorized free purchases or even getting
money credited instead of paying.

RELATED WEAKNESSES:

   Other CWE-1284

REFERENCES:


DEMONSTRATIVE EXAMPLES:

INTRO TEXT:

The following PHP code could be from a shopping cart application. It
allows users to apply a discount to an item.

BAD CODE:
LANGUAGE: PHP

<?php
 $discount = $_POST['discount'];
 $originalPrice = 100.00;
 $finalPrice = $originalPrice - ($originalPrice * $discount / 100);
 processPayment($finalPrice);
?>


EXPLANATORY TEXT:

However, this code does not validate or restrict the discount
percentage. An attacker could submit a discount value of 100%, making
the finalPrice zero, resulting in unauthorized free purchases.  A
discount greater than 100% could result in a negative value, allowing
the user to get money credited instead of paying.

GOOD CODE:
LANGUAGE: PHP

<<put the information here>>



ACTIVE ISSUES:

SUB.MISSDET - "Missing details"

Description: The submission is missing some requested or required details
for elements other than name and description.

Resolution: The submission cannot progress to later phases if it does not
have all required elements.

Comments: We have added your suggestion to the "DEMONSTRATIVE
EXAMPLES" section in this form.

 - We wrote some "INTRO TEXT" to describe the behavior that the code
   is attempting to do.  Please let us know if you agree with the
   introduction, or suggest how to change it.

  - We also added "EXPLANATORY TEXT" to the example, making small
    changes to your suggested explanation. Please let us know if you
    agree with the text, or suggest how to change it.

 - The "GOOD CODE" section needs to be filled in order to suggest to
   developers how they could address the weakness. Please provide us
   with example code that modifies the "bad code" in order to fix the
   weakness.

 - Finally, fill the "Response" below to indicate that you have made
   this change, or otherwise ask us for any clarification.

Response: <SUBMITTER SHOULD REPLY HERE>



RESOLVED ISSUES:




TIMELINE:

Received: 2025-02-28

Ack-Receipt: 2025-03-12

Init-Review: 2025-04-08

Init-Consultation: YYYY-MM-DD

Init-Declined: YYYY-MM-DD

Init-Accepted: 2025-05-20

Det-Requested: 2025-08-21

Det-Received: YYYY-MM-DD

Det-Review: YYYY-MM-DD

Det-Consultation: YYYY-MM-DD

Det-Accepted: YYYY-MM-DD

Internal-Update: YYYY-MM-DD

CWE-Assigned: YYYY-MM-DD

CWE-Modified: YYYY-MM-DD

Final-Coord: YYYY-MM-DD

CWE-Published: YYYY-MM-DD

Post-Publication: YYYY-MM-DD

Closed: YYYY-MM-DD




COMMUNICATIONS LOG:
2025-03-12 sent email
2025-04-08 sent email
2025-05-20 sent email
2025-08-21 sent email
