SUBMISSION COMMUNICATION ID: ES2502-159200de

ACTION TYPE: Modification

SUBMISSION STATUS: Init-Accepted

AFFECTED CWES: 

ORIGIN: sub-server

SUBMISSION DATE: 2025-02-28 15:16:10

ISSUES: yes/active

ISSUE DETAILS: SUB.MISC

PUBTRACKER: #142

MTRACKER: #1235

GITHUBUSER: ctflearner

SUBMISSION TYPE: Software

NAME: CWE-112 modification new demonstrative example

DESCRIPTION:

I want to suggest the below code for PHP language for the given
description.

Demonstrative Examples

````
$xmlFile = $_GET['file'];
$xml = simplexml_load_file($xmlFile);
echo $xml->asXML();
````

The above PHP code is vulnerable because it directly loads an XML file from
user input without validating its structure against a schema (XSD) or a
Document Type Definition (DTD). This lack of validation allows an attacker
to exploit XML External Entity (XXE) Injection, potentially accessing local
files or executing arbitrary requests on the server. Additionally, improper
handling of the file parameter can lead to file inclusion vulnerabilities,
allowing an attacker to load unexpected or malicious files from the server.

RELATED WEAKNESSES:

   Other CWE-112

REFERENCES:


ACTIVE ISSUES:

SUB.MISC - "Miscellaneous/other problem"

Description: The submission has some other problem that is not covered
elsewhere.

Resolution: This will depend on the nature of the problem.

Comments: This example is reasonable, but we will need to add more
details. In Stage 2, we will work with you to refine this example to
fit with CWE's expected style, such as introductory text and a "good
code" example to demonstrate the fix. We are also considering if it is
applicable to add to CWE-611. It looks like the commonly used PHP XML
validation library, libxml2, prevents XXE by
default. https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#:~:text=the%20NSXMLDocument.-,PHP,-%C2%B6 .

We also note that this example code is also subject to path traversal
(CWE-22), which could be confusing to the reader of CWE-112. In Stage
2, we will work with you to modify the example to avoid the path
traversal, such as by reading in XML content directly from the GET
rather than getting a file path and loading the XML from the path, or
validating that the filename is alphanumeric with a .xml extension, or
something similar.

Please respond to indicate that you have seen this comment.

Response: <SUBMITTER SHOULD REPLY HERE>




RESOLVED ISSUES:



TIMELINE:

Received: 2025-02-28

Ack-Receipt: 2025-03-11

Init-Review: 2025-05-28

Init-Consultation: YYYY-MM-DD

Init-Declined: YYYY-MM-DD

Init-Accepted: 2025-11-04

Det-Requested: YYYY-MM-DD

Det-Received: YYYY-MM-DD

Det-Review: YYYY-MM-DD

Det-Consultation: YYYY-MM-DD

Det-Accepted: YYYY-MM-DD

Internal-Update: YYYY-MM-DD

CWE-Assigned: YYYY-MM-DD

CWE-Modified: YYYY-MM-DD

Final-Coord: YYYY-MM-DD

CWE-Published: YYYY-MM-DD

Post-Publication: YYYY-MM-DD

Closed: YYYY-MM-DD




COMMUNICATIONS LOG:
2025-03-11 sent email
2025-05-28 sent email
2025-11-04 sent email
