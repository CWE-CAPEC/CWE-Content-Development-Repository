SUBMISSION COMMUNICATION ID: ES2502-159200de

ACTION TYPE: Modification

SUBMISSION STATUS: Det-Requested

AFFECTED CWES: 

ORIGIN: sub-server

SUBMISSION DATE: 2025-02-28 15:16:10

ISSUES: yes/active

ISSUE DETAILS: SUB.MISSDET

FIELDCHANGE: DEMOX

PUBTRACKER: #142

MTRACKER: #1235

GITHUBUSER: ctflearner

SUBMISSION TYPE: Software

NAME: CWE-112 modification new demonstrative example

DESCRIPTION:

I want to suggest the below code for PHP language for the given
description.

Demonstrative Examples

````
$xmlFile = $_GET['file'];
$xml = simplexml_load_file($xmlFile);
echo $xml->asXML();
````

The above PHP code is vulnerable because it directly loads an XML file from
user input without validating its structure against a schema (XSD) or a
Document Type Definition (DTD). This lack of validation allows an attacker
to exploit XML External Entity (XXE) Injection, potentially accessing local
files or executing arbitrary requests on the server. Additionally, improper
handling of the file parameter can lead to file inclusion vulnerabilities,
allowing an attacker to load unexpected or malicious files from the server.


DEMONSTRATIVE EXAMPLES:


INTRO TEXT:

The following PHP code receives a file argument for an XML file, loads
the XML file, and prints the results back to the user.

BAD CODE:
LANGUAGE: PHP

$xmlFile = $_GET['file'];
$xml = simplexml_load_file($xmlFile);
echo $xml->asXML();

EXPLANATORY TEXT:

The above PHP code is vulnerable because it directly loads an XML file
from user input without validating its structure against a schema
(XSD) or a Document Type Definition (DTD). This lack of validation
allows an attacker to exploit XML External Entity (XXE) Injection
(CWE-611), potentially accessing local files or executing arbitrary
requests on the server. Additionally, improper handling of the file
parameter can lead to file inclusion vulnerabilities (CWE-22),
allowing an attacker to load unexpected or malicious files from the
server.

GOOD CODE:
LANGUAGE: PHP

(SEE COMMENTS IN SUB.MISSDET)

possible "good" code:

     

<<put the information here>>



RELATED WEAKNESSES:

   Other CWE-112

REFERENCES:


ACTIVE ISSUES:

SUB.MISSDET - "Missing details"

Description: The submission is missing some requested or required details
for elements other than name and description.

Resolution: The submission cannot progress to later phases if it does not
have all required elements.

Comments: We have inserted your suggestion into the "DEMONSTRATIVE
EXAMPLES:" section; please review the raw submission file for details.

Please respond to the following comments and provide the appropriate
details. We can work with you to finalize this.

1) We have written an "INTRO TEXT" summary of what the code is
   attempting to do. Please let us know if you agree with this
   summary.

2) The demonstrative example needs to include a "GOOD CODE" example
   that avoids the multiple weaknesses that the "BAD CODE" has, such
   as path traversal (CWE-22). We suggest validating the $xmlFile
   result against a regular expression such as "/^\w+\.xml$/" such as:

      preg_match("/^\w+\.xml$/", $xmlFile)

   Let us know if you agree with this approach.

3) Once this demonstrative example is finished for CWE-112, the CWE
   plans to reuse it for CWE-22, and also adapt it for CWE-611 to use
   the PHP XML validation library, libxml2, which appears to prevent
   XXE by
   default. https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#:~:text=the%20NSXMLDocument.-,PHP,-%C2%B6

   We welcome your insights and suggestions on this approach.


Response: <SUBMITTER SHOULD REPLY HERE>




RESOLVED ISSUES:



TIMELINE:

Received: 2025-02-28

Ack-Receipt: 2025-03-11

Init-Review: 2025-05-28

Init-Consultation: YYYY-MM-DD

Init-Declined: YYYY-MM-DD

Init-Accepted: 2025-11-04

Det-Requested: 2025-11-04

Det-Received: YYYY-MM-DD

Det-Review: YYYY-MM-DD

Det-Consultation: YYYY-MM-DD

Det-Accepted: YYYY-MM-DD

Internal-Update: YYYY-MM-DD

CWE-Assigned: YYYY-MM-DD

CWE-Modified: YYYY-MM-DD

Final-Coord: YYYY-MM-DD

CWE-Published: YYYY-MM-DD

Post-Publication: YYYY-MM-DD

Closed: YYYY-MM-DD




COMMUNICATIONS LOG:
2025-03-11 sent email
2025-05-28 sent email
2025-11-04 sent email
2025-11-05 sent email
