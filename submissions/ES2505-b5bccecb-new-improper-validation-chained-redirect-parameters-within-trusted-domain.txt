SUBMISSION COMMUNICATION ID: ES2505-b5bccecb

ACTION TYPE: Modification

SUBMISSION STATUS: Init-Consultation

AFFECTED CWES: 

ORIGIN: sub-server

SUBMISSION DATE: 2025-05-17 00:55:42

ISSUES: yes/active

ISSUE DETAILS: SUB.OVERLAP, SUB.ABS.LOWLEVEL, SUB.RELREFS, SUB.ACTCHANGE

PUBTRACKER: #153

MTRACKER: #1258

GITHUBUSER: PharaohBM7

SUBMISSION TYPE: Software

NAME: Improper Validation of Chained Redirect Parameters within Trusted Domain

DESCRIPTION:

This weakness occurs when a web application performs multiple internal
redirections using user-controlled parameters, and fails to validate or
sanitize each redirection step within a trusted domain context. Although
each redirection appears to stay within the same domain, the final step may
result in the user being redirected to an attacker-controlled external URL.

This chained behavior often bypasses typical security controls like link
scanners, security policies (e.g., Content Security Policy, email
clients' link checkers), and even user awareness, because the attack
route seems to remain in a safe context until the very end.

General Explanation:
This weakness occurs when a web application performs multiple internal
redirections using user-controlled parameters, and fails to validate or
sanitize each redirection step within a trusted domain context. Although
each redirection appears to stay within the same domain, the final step may
result in the user being redirected to an attacker-controlled external URL.

This chained behavior often bypasses typical security controls like link
scanners, security policies (e.g., Content Security Policy, email
clients' link checkers), and even user awareness, because the attack
route seems to remain in a safe context until the very end.

 Why it's a Concern:
Developers often assume that a redirect is only dangerous if it directly
leads to an external domain. However, a series of internal redirects -
all within the same trusted domain - can be crafted in such a way that
the final destination is malicious.

This opens the door to advanced phishing attacks, user impersonation,
credential harvesting, and abuse of trusted domain reputation (e.g.,
government or banking domains).

 Technical Impact:
Security Policy Bypass: May bypass domain-based security policies (e.g.,
CSP).

Phishing & Social Engineering: Used in highly convincing phishing
campaigns.

Abuse of Brand Trust: Misuses trusted domains to appear safe.

Redirect Chains Evading Detection: Makes automated scanners fail to
identify the final malicious target.

 Variations/Subtleties:
Redirection can happen through different endpoints (e.g., /login,
/redirect, /tracking) chained together.

Each step individually appears safe, and may even validate correctly, but
when combined, result in malicious behavior.

Some sites rely on internal redirects to handle language preferences, SSO
flows, or campaign tracking u2014 which attackers can exploit as part of
the chain.

 Example Use Case:

bash
Copy
Edit
https://secure.gov/login?next=/track?id=435&url=/redirect?dest=https://evil.com
Each endpoint believes it's handing off safely to another internal
resource, but the chain eventually leaks to an external domain.


RELATED WEAKNESSES:

   ChildOf CWE-601

REFERENCES:

Title: Advanced Chained Redirects within Trusted Domainst
URL: https://gist.github.com/PharaohBM7/fake123456example


ACTIVE ISSUES:

SUB.OVERLAP - "Duplicate/Overlap"

Description: The submission identifies a weakness, but it is a duplicate of
(or partially overlaps) existing weaknesses or other submissions,
indicating problems with the submission or associated CWE entries.

Resolution: The submission cannot progress to later phases until (1) the
duplicate/overlap is understood and (2) it is clear how to resolve this
duplicate/overlap.

Comments: The provided submission is a different way of exploiting an 
Open Redirect, and not a different weakness. Although there is a chain of 
redirects, the ultimate weakness is that the application is doing a redirect 
based on user input. We can include your suggestion as an example which shows 
a redirect chain as part of CWE-601. Let us know if you are okay with this 
approach.

Response: <SUBMITTER SHOULD REPLY HERE>


----------

SUB.ABS.LOWLEVEL - "Low level of abstraction"

Description: The submission identifies an issue, but its abstraction might
be too low-level to merit its own CWE entry. If it is focused on a
particular technology, framework, protocol, or function, then it might not
be unique enough to get its own CWE ID.  This might lead to modification of
an existing entry to include the additional details, or creation of a
higher-level entry for which the submission is one example. (Note: some
older CWE entries have this problem and would not be published today,
generally because they were too specific to a particular language.)

Resolution: The submission will be allowed to progress to later phases once
the more-general concept is appropriately identified and described. The
original, lower-level submission will serve as a primary example of the
more general concept.

Comments: Although there is a chain of redirects, the ultimate weakness is 
that the application is doing a redirect based on user input. This distinction 
of using chained redirects is too low level to warrant a child entry to 
CWE-601. Please confirm if you agree with this.

Response: <SUBMITTER SHOULD REPLY HERE>


----------

SUB.RELREFS - "No relevant references"

Description: The submission does not provide relevant references that
explain the weakness, or the relevance is not easily found.

Resolution: The submission is not likely to progress to later phases if
there are no applicable, easily-accessible references. The submitter could
resolve by providing additional details such as a section name and quote
from the reference.  If no suitable references can be found, the CWE Team
may decide to make an exception.

Comments: The GitHub reference currently leads to a 404 error. Could you 
please provide alternative references or real-world examples that demonstrate 
the significance of this weakness?

Response: <SUBMITTER SHOULD REPLY HERE>


----------

SUB.ACTCHANGE - "Change in action for submission"

Description: The submission's action needs to change, e.g., from "New
Entry" to "Modification," or vice versa. This potentially requires changes
to the kinds of information that will need to be provided.

Resolution: The submission cannot progress to Stage 3 (Content-Generation)
until the informational needs are addressed.

Comments: As mentioned in SUB.OVERLAP, your submission highlights another 
way of doing an Open Redirect. As such, we would be happy to modify CWE-601
to include redirect chains. Please let us know if you agree with the change.

Response: <SUBMITTER SHOULD REPLY HERE>


----------

RESOLVED ISSUES:



TIMELINE:

Received: 2025-05-17

Ack-Receipt: 2025-05-27

Init-Review: 2025-07-17

Init-Consultation: 2025-11-06

Init-Declined: YYYY-MM-DD

Init-Accepted: YYYY-MM-DD

Det-Requested: YYYY-MM-DD

Det-Received: YYYY-MM-DD

Det-Review: YYYY-MM-DD

Det-Consultation: YYYY-MM-DD

Det-Accepted: YYYY-MM-DD

Internal-Update: YYYY-MM-DD

CWE-Assigned: YYYY-MM-DD

CWE-Modified: YYYY-MM-DD

Final-Coord: YYYY-MM-DD

CWE-Published: YYYY-MM-DD

Post-Publication: YYYY-MM-DD

Closed: YYYY-MM-DD




COMMUNICATIONS LOG:
2025-05-27 sent email
2025-07-17 sent email
2025-11-06 sent email
