SUBMISSION COMMUNICATION ID: ES2407-4edbed28

ACTION TYPE: Undetermined

SUBMISSION STATUS: Init-Consultation

AFFECTED CWES: 

ORIGIN: sub-server

SUBMISSION DATE: 2024-07-04 23:10:12

ISSUES: yes/active

ISSUE DETAILS: SUB.UNCLEAR, SUB.ATTACK, SUB.RELS, SUB.ABS.LOWLEVEL, SUB.RELREFS, SUB.ACTION

PUBTRACKER: #116

MTRACKER: #1114

GITHUBUSER: mbiesiad

SUBMISSION TYPE: Software

NAME: Misconfigurations and CSRF can leads to DoS/DDoS

DESCRIPTION:

Many requests because of error ERR_TOO_MANY_REDIRECTS (about x50 requests
per single payload/visit) linked in with CSRF (ie.: automated GET using img - that
means no user interaction) can leads to DoS/DDoS.
Example: User visit the vulnerable site and spot the ERR_TOO_MANY_REDIRECTS
(single visit/request triggered automated 50 requests without user's
knowledge). In combination with CSRF the threat is bigger.
If bad actor will use payload similar like mentioned (ie.: at vulnerable or
malicious sites) with many visitors - victims (visitors) will make requests
without their knowledge. If site has x10/100,000 visitors (in the
approximate time) - the final requests nr will strongly increasing
(multiplication).
In my opinion, it would be good to investigate this security issue.

Encountering the 'ERR_TOO_MANY_REDIRECTS' error on a site indicates that
the browser is stuck in an infinite redirection loop. This problem can
arise from various misconfigurations and potential security issues. Let's
break down the possible causes, security threats, and implications.

Causes of 'ERR_TOO_MANY_REDIRECTS' Error:
Misconfigured Redirects: Incorrect configuration in server settings, such
as .htaccess files, web server settings (Apache, Nginx), or application
code, leading to a redirection loop.
Improper SSL/TLS Configuration: Redirect loops can occur when HTTP is
incorrectly redirected to HTTPS, or vice versa, in an endless loop.
Third-party Services: Issues with CDN (Content Delivery Network), load
balancers, or proxy servers can also cause redirect loops.
Cookies: Some sites use cookies to manage redirects, and incorrect handling
or corruption of these cookies can result in a loop.

Security Issues and Threats:
1. Denial of Service (DoS) and Distributed Denial of Service (DDoS) Threats
Resource Exhaustion: Attackers could exploit redirect loops to cause
excessive resource usage on the server, leading to a DoS or DDoS situation.
Each redirection request consumes server resources, potentially
overwhelming the server.
Amplification Attack: If multiple clients are redirected continuously, it
can amplify the server load significantly, leading to a DDoS attack.
2. Cross-Site Request Forgery (CSRF)
CSRF with GET Requests: If a site is vulnerable to CSRF and uses GET
requests to perform state-changing operations (which is bad practice), an
attacker could cause a client to follow a redirection loop by sending a
maliciously crafted URL. However, modern CSRF protections often require the
use of tokens, which mitigate this risk.
Combined Threats: A CSRF vulnerability could be used in conjunction with
the redirect loop to force a user into an unintended loop, potentially
leading to resource exhaustion on the client side and deteriorating the
user experience.
3. Client-Side Impact
Denial of Access: Clients will be unable to access the site, leading to
frustration and potentially driving users away.
Browser Crashes: Continuous redirects can cause browser instability or
crashes, further impacting the user's experience.

Implications:
1. Loss of Reputation
User Frustration: Users who encounter redirect loops are likely to view the
site as unreliable or poorly maintained.
Search Engine Rankings: Search engines might penalize the site in their
rankings due to poor user experience and frequent errors, leading to
reduced visibility.
2. Security Perception
Trust Issues: Persistent errors can erode trust in the site's security,
making users hesitant to interact with it or enter sensitive information.
Possible Exploits: Users and security analysts might suspect underlying
security issues, such as potential vulnerabilities being exploited.

Mitigation Strategies:
Proper Configuration: Ensure redirects are correctly configured and tested
to prevent loops. Regular audits and automated tests can help identify and
fix issues early.
SSL/TLS Handling: Ensure HTTPS redirection is properly configured and
tested. Tools and services that validate SSL/TLS setups can help identify
misconfigurations.
Robust CSRF Protection: Implement CSRF tokens and ensure state-changing
operations use POST requests with proper validation.
Monitoring and Logging: Use monitoring tools to detect unusual patterns in
redirect behavior and server load, which can indicate potential DoS/DDoS
attempts.
User Communication: Provide clear error messages and potential solutions to
users encountering redirect issues, such as clearing cookies or contacting
support.

In summary, 'ERR_TOO_MANY_REDIRECTS' can be a symptom of various
configuration and security issues. Proper diagnosis and mitigation are
essential to maintaining site availability, performance, and security.

Best regards,

RELATED WEAKNESSES:

   Other CWE-352

REFERENCES:

Title: CWE-352: Cross-Site Request Forgery (CSRF)
URL: https://cwe.mitre.org/data/definitions/352.html

Title: CAPEC-62: Cross Site Request Forgery
URL: https://capec.mitre.org/data/definitions/62.html

Title: Cross Site Request Forgery (CSRF)
URL: https://owasp.org/www-community/attacks/csrf

Title: 302 Found
URL: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302

Title: Network Denial of Service
URL: https://attack.mitre.org/techniques/T1498/


ACTIVE ISSUES:


SUB.UNCLEAR - "Unclear weakness"

Description: The submission's name and/or description does not clearly
identify a weakness, or it is written in a way that is vague and could
cause the submission to be incorrectly mapped to.

Resolution: A submission cannot progress past the consultation phase until
SUB.UNCLEAR is addressed.

Comments: The current submission includes lots of detail, but it seems that the true focus
is the weakness of a webpage allowing a redirect loop.  We want to ensure we focus on 
fleshing out the exact root cause weakness at this stage.  Please indicate if you agree 
with focusing on the redirect loops.

Response: <SUBMITTER SHOULD REPLY HERE>


----------

SUB.ATTACK - "Too attack-focused"

Description: The submission's name and/or description emphasizes the
attack, not the weakness. Either the submission's weakness is not
well-understood, or it is better described as an attack pattern, which may
be suitable for inclusion in CAPEC.

Resolution: An initial submission cannot progress to later phases unless it
also includes a clear weakness (i.e., is not subject to SUB.UNCLEAR).

Comments: The current submission discusses how denial of service attacks can be
carried out by exploiting redirect loops.  It also discusses how CSRF attacks can be
used in conjunction to aid with the attack.  The currently suggested name also incorporates
these two attack vectors.  We believe that the discussion around these two attacks makes
the submission too attack focused and we need to focus more on the weakness of the 
redirect loops.  Please indicate if you agree the discussion around DoS and CSRF is too
attack focused.

Response: <SUBMITTER SHOULD REPLY HERE>


----------

SUB.RELS - "Unclear relationships"

Description: The submission suggests some relationships, but the
name/description is not explained in a way in which the relationship is
relevant; or, the weakness is apparent, but it is not clear what the best
parent/child relationship(s) would be.

Resolution: The submission cannot progress to the next phase if SUB.UNCLEAR
is present. It can progress to other phases if the CWE Team agrees that the
potential relationships may require closer investigation.  The submission
cannot progress to the Publication stage until clear relationships and
direct parents are identified. The CWE Team may decide to use high-level
relationships (e.g., to Pillars) if deeper problems such as SUB.ABS.SUBTREE
exist and cannot be quickly resolved.

Comments: The current submission suggests CWE-352 as a relationship, although
if we are focusing on the redirect loop issue, then CSRF should not be related at all.
The only relationship would be as part of an attack that combines multiple weaknesses, 
but this is not in scope.  The CWE team believes that a weakness around redirect loops 
would be fitting in the CWE-834 subtree, which is for "Excessive Iteration".  Please
indicate if you agree with the CWE-834 subtree being a good fit for a parent or potential
modification if we determine that is the best course of action.

Response: <SUBMITTER SHOULD REPLY HERE>


----------

SUB.ABS.LOWLEVEL - "Low level of abstraction"

Description: The submission identifies an issue, but its abstraction might
be too low-level to merit its own CWE entry. If it is focused on a
particular technology, framework, protocol, or function, then it might not
be unique enough to get its own CWE ID.  This might lead to modification of
an existing entry to include the additional details, or creation of a
higher-level entry for which the submission is one example. (Note: some
older CWE entries have this problem and would not be published today,
generally because they were too specific to a particular language.)

Resolution: The submission will be allowed to progress to later phases once
the more-general concept is appropriately identified and described. The
original, lower-level submission will serve as a primary example of the
more general concept.

Comments: It is unclear at this time until we understand the exact weakness more clearly
if this submission is too low level or not.  We already have CWE entries that cover
excessive iteration and infinite loops, so specific redirect loops might be too low level
to warrant a new CWE entry.  We will have more discussions on whether or not this 
submission is better suited as a modification to an existing entry to discuss redirect 
loops once we better understand the weakness.  Please indicate that you have seen this 
comment.

Response: <SUBMITTER SHOULD REPLY HERE>


----------

SUB.RELREFS - "No relevant references"

Description: The submission does not provide relevant references that
explain the weakness, or the relevance is not easily found.

Resolution: The submission is not likely to progress to later phases if
there are no applicable, easily-accessible references. The submitter could
resolve by providing additional details such as a section name and quote
from the reference.  If no suitable references can be found, the CWE Team
may decide to make an exception.

Comments: The current submission does not include any references that discuss 
redirect loops.  The references only describe general CSRF and DoS attacks, as
well as a reference that just explains the redirect HTTP response.  Please include
a reference that specifically talks to the weakness regarding redirect loops.

Response: <SUBMITTER SHOULD REPLY HERE>


----------

SUB.ACTION - "Unable to determine action"

Description: It is not clear what action to perform based on the
submission, e.g., create new entry, update existing entry, etc.

Resolution: The submission cannot progress to the Internal-Update stage
until the relevant actions(s) are identified.

Comments: Based on the submission problems discussed above, mainly SUB.RELS
and SUB.ABS.LOWLEVEL, more discussion will be needed to determine whether
this submission is better suited as it's own entry or a modification to a 
CWE in the CWE-834 tree.  Please indicate you have seen this comment.

Response: <SUBMITTER SHOULD REPLY HERE>


----------



RESOLVED ISSUES:



TIMELINE:

Received: 2024-07-04

Ack-Receipt: 2024-07-31

Init-Review: 2025-04-29

Init-Consultation: 2025-08-25

Init-Declined: YYYY-MM-DD

Init-Accepted: YYYY-MM-DD

Det-Requested: YYYY-MM-DD

Det-Received: YYYY-MM-DD

Det-Review: YYYY-MM-DD

Det-Consultation: YYYY-MM-DD

Det-Accepted: YYYY-MM-DD

Internal-Update: YYYY-MM-DD

CWE-Assigned: YYYY-MM-DD

CWE-Modified: YYYY-MM-DD

Final-Coord: YYYY-MM-DD

CWE-Published: YYYY-MM-DD

Post-Publication: YYYY-MM-DD

Closed: YYYY-MM-DD




COMMUNICATIONS LOG:
2024-07-31 sent email
2025-04-29 sent email
2025-08-25 sent email
